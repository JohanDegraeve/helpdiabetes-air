<?xml version="1.0" encoding="utf-8"?>
<!--
Copyright (C) 2011  hippoandfriends

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/gpl.txt>.

-->
<s:TabbedMobileApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
					 xmlns:s="library://ns.adobe.com/flex/spark" 
					 initialize="initApplication()">
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
			import databaseclasses.Database;
			import databaseclasses.DatabaseEvent;
			import databaseclasses.DatabaseResponder;
			
			/**
			 * here's where the database is initialized and if completed the dataprovider for foodcounterview will be updated. 
			 */
			private function initApplication():void {
				var internalResponder:DatabaseResponder = new DatabaseResponder();
				internalResponder.addEventListener(DatabaseEvent.RESULT_EVENT,onResult);
				internalResponder.addEventListener(DatabaseEvent.ERROR_EVENT,onError);
				Database.getInstance().init(internalResponder);
				
				function onResult(de:DatabaseEvent):void
				{
					internalResponder.removeEventListener(DatabaseEvent.ERROR_EVENT, onError);
					internalResponder.removeEventListener(DatabaseEvent.RESULT_EVENT, onResult);				
				}
				
				function onError(de:DatabaseEvent):void
				{				
					internalResponder.removeEventListener(DatabaseEvent.ERROR_EVENT, onError);
					internalResponder.removeEventListener(DatabaseEvent.RESULT_EVENT, onResult);
				}
			}

		]]>
	</fx:Script>
	<s:ViewNavigator id="Counter" label="Counter" width="100%" height="100%"
					 firstView="views.FoodCounterView"/>
	<s:ViewNavigator id="Track" label="Track" width="100%" height="100%"
					 firstView="views.TrackingView"/>
	<s:ViewNavigator id="Table" label="Table" width="100%" height="100%"
					 firstView="views.FoodTableView"/>
	<s:ViewNavigator id="Settings" label="Settings" width="100%" height="100%"
					 firstView="views.SettingsView"/>
	<s:ViewNavigator id="InfoAndHelp" label="?" width="100%" height="100%"
					 firstView="views.InfoAndHelpView"/>
</s:TabbedMobileApplication>
