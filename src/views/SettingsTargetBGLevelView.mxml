<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
		xmlns:s="library://ns.adobe.com/flex/spark"
		creationComplete="view1_creationCompleteHandler(event)"
		initialize="onInit()">
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	<fx:Metadata>
		[ResourceBundle("general")]
		[ResourceBundle("settingstargetbglevelview")]
	</fx:Metadata>
	<fx:Script>
		<![CDATA[
			import mx.events.FlexEvent;
			import mx.managers.PopUpManager;
			
			import spark.components.View;
			
			import databaseclasses.Settings;
			
			import myComponents.AmountPicker;
			import myComponents.HelpCallOut;
			import myComponents.PickerEvent;
			
			private var amountPicker:AmountPicker;
			
			private var thisView:View;
			
			[Bindable]
			private var back_label:String;
			
			private var helpCallOut:HelpCallOut;
			
			protected function view1_creationCompleteHandler(event:FlexEvent):void
			{
			}
			
			private function onInit():void {
				back_label = resourceManager.getString('general','back');
				thisView = this;
			}
			
			private function targetBGLevelClicked(event:Event):void  {
				amountPicker = new AmountPicker();
				amountPicker.amount = Settings.getInstance().getSetting(Settings.SettingsTARGET_BLOODGLUCOSELEVEL);
				amountPicker.maxNonDecimalDigits = 3;
				amountPicker.decimalDigits = 0;
				//amountPicker.labelText1 = resourceManager.getString('editmedicineventview','amount_of_units');
				amountPicker.addEventListener(PickerEvent.PICKER_SET, onAmountSet);
				amountPicker.addEventListener(PickerEvent.PICKER_CANCEL, onAmountCancel);
				
				PopUpManager.addPopUp(amountPicker, this, true);
				PopUpManager.centerPopUp(amountPicker);
				
				function onAmountCancel(event: PickerEvent): void
				{
					amountPicker.removeEventListener(PickerEvent.PICKER_SET, onAmountSet);
					amountPicker.removeEventListener(PickerEvent.PICKER_CANCEL, onAmountCancel);
				}
				
				function onAmountSet(event: PickerEvent): void
				{
					amountPicker.removeEventListener(PickerEvent.PICKER_SET, onAmountSet);
					amountPicker.removeEventListener(PickerEvent.PICKER_CANCEL, onAmountCancel);
					targetBGLevelButton.label = (event.newValue as Number).toString();
					Settings.getInstance().setSetting(Settings.SettingsTARGET_BLOODGLUCOSELEVEL,targetBGLevelButton.label );
				}
			}
		]]>
	</fx:Script>
	<s:navigationContent>
		<s:Button   label="{back_label}" id="backButton" click="navigator.popView()" height="48"/>
	</s:navigationContent>
	<s:Group y="0" x="0" width="100%" left="5" top="5" right="5">
		<s:layout>
			<s:VerticalLayout>
			</s:VerticalLayout>
		</s:layout>
		<s:Group id="bglevel" y="0" x="0" width="100%" height = "100%"  click="targetBGLevelClicked(event)">
			<s:layout>
				<s:HorizontalLayout verticalAlign="middle">
				</s:HorizontalLayout>
			</s:layout>
			<s:Label  width="60%" text="{resourceManager.getString('settingstargetbglevelview','targetbglevel') }" />
			<s:Button id="targetBGLevelButton" width="40%" label="{Settings.getInstance().getSetting(Settings.SettingsTARGET_BLOODGLUCOSELEVEL)}"  />
		</s:Group>
	</s:Group>
</s:View>
